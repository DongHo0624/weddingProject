<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="simulator">
	<!-- 업체번호, 코드, 업체명, 기본 가격, 전화번호, 주소, 태그, 이미지경로 -->
	<!-- 검색조건 -> 홀:지역,인원수/드레스:지역/스튜디오:지역/메이크업:지역 -->
	<select id="hSearchList" parameterType="simulator" resultType="hall">
		select 
			hall_no as hallNo,
			code as code,
			hall_name as hallName,
			hall_price as hallPrice,
			hall_tel as hallTel,
			hall_addr as hallAddr,
			hall_tag as hallTag,
			hall_path as hallPath
		from
			hall
		<if test="!weddingLoc.equals('전국')">
			where
				hall_loc like '%'||#{weddingLoc}||'%'
		</if>
	</select>
	<select id="dSearchList" parameterType="map" resultType="dress">
		select 
			dress_no as dressNo,
			code,
			dress_name as dressName,
			dress_rent_price as dressRentPrice,
			dress_tel as dressTel,
			dress_addr ad dressAddr,
			dress_tag as dressTag,
			dress_filepath as dressFilepath 
		from (select rownum as rnum, d.* from (select * from dress<if test="!simulator.equals('전국')"> where dress_addr like '%'||#{simulator}||'%'</if>) d) where rnum between ${start} and ${end}
	</select>
	<select id="dTotalCount" parameterType="simulator" resultType="_int">
		select 
			count(*)
		from 
			dress
		<if test="!weddingLoc.equals('전국')">
		where
			dress_addr like '%'||#{weddingLoc}||'%'
		</if>
	</select>
	<select id="ajaxDressList" parameterType="map" resultType="dress">
		select 
			dressNo,
			code,
			dressName,
			dressRentPrice,
			dressTel,
			dressAddr,
			dressTag,
			dressFilepath
		from
			(select 
				rownum as rnum,
				d.*
			from
				(select * from dress) d
			<if test="!weddingLoc.equals('전국')">
			where
				dress_addr like '%'||#{weddingLoc}||'%'
			</if>
			)
		where rnum between #{start} and #{end}
	</select>
</mapper>
